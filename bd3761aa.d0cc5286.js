(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{90:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return r})),n.d(t,"metadata",(function(){return c})),n.d(t,"toc",(function(){return o})),n.d(t,"default",(function(){return l}));var i=n(3),a=(n(0),n(102));const r={id:"kernelpatches",title:"Creating Kernel Patches",sidebar_label:"Creating Kernel Patches"},c={unversionedId:"dev/guides/kernelpatches",id:"dev/guides/kernelpatches",isDocsHomePage:!1,title:"Creating Kernel Patches",description:"Creating Kernel Patches for Netkit-JH",source:"@site/docs/dev/guides/kernelpatches.md",slug:"/dev/guides/kernelpatches",permalink:"/docs/dev/guides/kernelpatches",editUrl:"https://github.com/netkit-jh/netkit-jh.github.io/edit/master/docs/dev/guides/kernelpatches.md",version:"current",sidebar_label:"Creating Kernel Patches",sidebar:"someSidebar",previous:{title:"Building Netkit-JH with Docker",permalink:"/docs/dev/guides/dockerbuild"}},o=[{value:"Creating Kernel Patches for Netkit-JH",id:"creating-kernel-patches-for-netkit-jh",children:[]}],s={toc:o};function l({components:e,...t}){return Object(a.b)("wrapper",Object(i.a)({},s,t,{components:e,mdxType:"MDXLayout"}),Object(a.b)("h2",{id:"creating-kernel-patches-for-netkit-jh"},"Creating Kernel Patches for Netkit-JH"),Object(a.b)("p",null,"Netkit uses a few kernel patches to apply changes to the kernel before being built. These kernel patches add additional functionality to the UML kernel to assist the running of Netkit. One example of a kernel patch is the addition of random MAC addresses assigned to network interfaces, created from the machine's name and name of the network interface, making MAC address collisions very rare."),Object(a.b)("p",null,'To create kernel patches, firstly create two copies of the Linux kernel source code - using the same version that is used in the UML Debian package. Note, replace "5.9" with the kernel version that UML is currently using.'),Object(a.b)("pre",null,Object(a.b)("code",Object(i.a)({parentName:"pre"},{}),"apt source linux-source-5.9\nmv linux-source-5.9 a\ncp a b\n")),Object(a.b)("p",null,"Now there is two folders with identical source code. Modify the source code within a with whatever changes are required. Once you have modified the code, run this command to produce a patch file:"),Object(a.b)("pre",null,Object(a.b)("code",Object(i.a)({parentName:"pre"},{}),"diff -urpN a b > 93-tutorial-patch.patch\n")),Object(a.b)("p",null,"Once you have a .patch file, move it to ",Object(a.b)("inlineCode",{parentName:"p"},"netkit-jh-build/kernel/patches/")," and name it appropiately. Also add this file name to the ",Object(a.b)("inlineCode",{parentName:"p"},"series")," file."),Object(a.b)("p",null,"Now you can build as normal. If all goes well, you should see something like this:"),Object(a.b)("pre",null,Object(a.b)("code",Object(i.a)({parentName:"pre"},{}),"Applying patch /home/debian/netkit-jh-build/kernel/build/user-mode-linux-5.9um1/debian/patches/93-tutorial-patch.patch\npatching file arch/um/os-Linux/umid.c\n")))}l.isMDXComponent=!0}}]);